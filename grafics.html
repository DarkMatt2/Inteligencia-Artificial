<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagramas de Arquitectura - Detector AI vs Real</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            margin: 0;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        h1 {
            color: #2d3748;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2em;
        }
        .subtitle {
            text-align: center;
            color: #718096;
            margin-bottom: 40px;
            font-size: 1.1em;
        }
        .diagram-section {
            margin-bottom: 50px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 20px;
            background: #f7fafc;
        }
        .diagram-title {
            color: #2c5282;
            font-size: 1.5em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #4299e1;
        }
        svg {
            display: block;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .controls {
            text-align: center;
            margin-bottom: 30px;
        }
        button {
            background: #4299e1;
            color: white;
            border: none;
            padding: 12px 30px;
            margin: 0 10px;
            border-radius: 25px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(66, 153, 225, 0.3);
        }
        button:hover {
            background: #3182ce;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(66, 153, 225, 0.4);
        }
        .legend {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 20px;
            padding: 15px;
            background: white;
            border-radius: 8px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9em;
            color: #4a5568;
        }
        .legend-box {
            width: 30px;
            height: 20px;
            border-radius: 4px;
            border: 2px solid #2d3748;
        }
        @media print {
            body { background: white; }
            .controls { display: none; }
            .diagram-section { page-break-after: always; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üèóÔ∏è Arquitectura del Sistema</h1>
        <p class="subtitle">Detector de Im√°genes AI vs Real - Diagramas T√©cnicos</p>
        
        <div class="controls">
            <button onclick="window.print()">üì• Descargar PDF</button>
            <button onclick="downloadAllSVGs()">üíæ Descargar SVGs</button>
        </div>

        <!-- Diagrama 1: Arquitectura General -->
        <div class="diagram-section">
            <h2 class="diagram-title">1. Arquitectura General del Sistema</h2>
            <svg width="1200" height="600" xmlns="http://www.w3.org/2000/svg">
                <!-- Background -->
                <rect x="0" y="0" width="1200" height="600" fill="#f8f9fa"/>
                
                <!-- Red Universitaria Container -->
                <rect x="50" y="50" width="1100" height="500" fill="#e8f4f8" stroke="#0066cc" stroke-width="3" rx="10"/>
                <text x="600" y="85" font-size="20" font-weight="bold" text-anchor="middle" fill="#0066cc">Red Universitaria UAC (192.168.41.0/24)</text>
                
                <!-- Usuario/Cliente -->
                <rect x="100" y="150" width="200" height="120" fill="#fff" stroke="#333" stroke-width="2" rx="8"/>
                <text x="200" y="190" font-size="16" font-weight="bold" text-anchor="middle">üë§ Usuario</text>
                <text x="200" y="215" font-size="14" text-anchor="middle" fill="#666">Cliente Web</text>
                <text x="200" y="240" font-size="13" text-anchor="middle" fill="#999">Navegador</text>
                <text x="200" y="260" font-size="12" text-anchor="middle" fill="#999">(Chrome/Firefox)</text>
                
                <!-- Servidor -->
                <rect x="850" y="150" width="250" height="350" fill="#fff" stroke="#333" stroke-width="2" rx="8"/>
                <text x="975" y="180" font-size="16" font-weight="bold" text-anchor="middle">üñ•Ô∏è Servidor</text>
                <text x="975" y="205" font-size="14" text-anchor="middle" fill="#0066cc">192.168.41.200</text>
                
                <!-- Frontend Box -->
                <rect x="880" y="230" width="190" height="80" fill="#e3f2fd" stroke="#1976d2" stroke-width="2" rx="5"/>
                <text x="975" y="255" font-size="14" font-weight="bold" text-anchor="middle" fill="#1976d2">Frontend</text>
                <text x="975" y="275" font-size="12" text-anchor="middle">Puerto: 5500</text>
                <text x="975" y="295" font-size="11" text-anchor="middle" fill="#666">index.html + JS</text>
                
                <!-- Backend Box -->
                <rect x="880" y="330" width="190" height="80" fill="#e8f5e9" stroke="#388e3c" stroke-width="2" rx="5"/>
                <text x="975" y="355" font-size="14" font-weight="bold" text-anchor="middle" fill="#388e3c">Backend API</text>
                <text x="975" y="375" font-size="12" text-anchor="middle">Puerto: 8000</text>
                <text x="975" y="395" font-size="11" text-anchor="middle" fill="#666">FastAPI + Uvicorn</text>
                
                <!-- Modelo Box -->
                <rect x="880" y="430" width="190" height="60" fill="#fff3e0" stroke="#f57c00" stroke-width="2" rx="5"/>
                <text x="975" y="455" font-size="14" font-weight="bold" text-anchor="middle" fill="#f57c00">Modelo PyTorch</text>
                <text x="975" y="475" font-size="11" text-anchor="middle" fill="#666">MobileNetV3-Small</text>
                
                <!-- Arrows -->
                <!-- Usuario to Frontend -->
                <path d="M 300 210 L 850 270" stroke="#4CAF50" stroke-width="3" fill="none" marker-end="url(#arrowgreen)"/>
                <text x="500" y="230" font-size="12" fill="#4CAF50" font-weight="bold">HTTP Request</text>
                
                <!-- Frontend to Backend -->
                <path d="M 975 310 L 975 330" stroke="#FF9800" stroke-width="3" fill="none" marker-end="url(#arroworange)"/>
                <text x="1000" y="325" font-size="11" fill="#FF9800">API Call</text>
                
                <!-- Backend to Modelo -->
                <path d="M 975 410 L 975 430" stroke="#9C27B0" stroke-width="3" fill="none" marker-end="url(#arrowpurple)"/>
                <text x="1000" y="425" font-size="11" fill="#9C27B0">Inference</text>
                
                <!-- Response arrow -->
                <path d="M 850 250 L 300 210" stroke="#2196F3" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowblue)"/>
                <text x="500" y="250" font-size="12" fill="#2196F3" font-weight="bold">Response</text>
                
                <!-- Arrow markers -->
                <defs>
                    <marker id="arrowgreen" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                        <path d="M0,0 L0,6 L9,3 z" fill="#4CAF50"/>
                    </marker>
                    <marker id="arroworange" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                        <path d="M0,0 L0,6 L9,3 z" fill="#FF9800"/>
                    </marker>
                    <marker id="arrowpurple" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                        <path d="M0,0 L0,6 L9,3 z" fill="#9C27B0"/>
                    </marker>
                    <marker id="arrowblue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                        <path d="M0,0 L0,6 L9,3 z" fill="#2196F3"/>
                    </marker>
                </defs>
                
                <!-- Middle connection box -->
                <rect x="400" y="350" width="300" height="100" fill="#ffffff" stroke="#666" stroke-width="2" rx="8" stroke-dasharray="5,5"/>
                <text x="550" y="385" font-size="14" font-weight="bold" text-anchor="middle">üîÑ Flujo de Datos</text>
                <text x="550" y="410" font-size="11" text-anchor="middle" fill="#666">1. Usuario sube imagen</text>
                <text x="550" y="428" font-size="11" text-anchor="middle" fill="#666">2. Backend procesa y predice</text>
                <text x="550" y="446" font-size="11" text-anchor="middle" fill="#666">3. Retorna probabilidades</text>
            </svg>
        </div>

        <!-- Diagrama 2: Flujo de Inferencia -->
        <div class="diagram-section">
            <h2 class="diagram-title">2. Flujo de Inferencia Detallado</h2>
            <svg width="1200" height="700" xmlns="http://www.w3.org/2000/svg">
                <rect x="0" y="0" width="1200" height="700" fill="#f8f9fa"/>
                
                <!-- Column headers -->
                <rect x="50" y="30" width="250" height="50" fill="#42a5f5" rx="5"/>
                <text x="175" y="62" font-size="16" font-weight="bold" text-anchor="middle" fill="white">Usuario</text>
                
                <rect x="350" y="30" width="250" height="50" fill="#66bb6a" rx="5"/>
                <text x="475" y="62" font-size="16" font-weight="bold" text-anchor="middle" fill="white">Frontend</text>
                
                <rect x="650" y="30" width="250" height="50" fill="#ffa726" rx="5"/>
                <text x="775" y="62" font-size="16" font-weight="bold" text-anchor="middle" fill="white">Backend API</text>
                
                <rect x="950" y="30" width="200" height="50" fill="#ab47bc" rx="5"/>
                <text x="1050" y="62" font-size="16" font-weight="bold" text-anchor="middle" fill="white">Modelo</text>
                
                <!-- Vertical lines -->
                <line x1="175" y1="80" x2="175" y2="670" stroke="#42a5f5" stroke-width="2" stroke-dasharray="5,5"/>
                <line x1="475" y1="80" x2="475" y2="670" stroke="#66bb6a" stroke-width="2" stroke-dasharray="5,5"/>
                <line x1="775" y1="80" x2="775" y2="670" stroke="#ffa726" stroke-width="2" stroke-dasharray="5,5"/>
                <line x1="1050" y1="80" x2="1050" y2="670" stroke="#ab47bc" stroke-width="2" stroke-dasharray="5,5"/>
                
                <!-- Step 1 -->
                <rect x="75" y="110" width="200" height="50" fill="#e3f2fd" stroke="#42a5f5" stroke-width="2" rx="5"/>
                <text x="175" y="135" font-size="13" text-anchor="middle" font-weight="bold">1. Seleccionar imagen</text>
                <text x="175" y="152" font-size="11" text-anchor="middle" fill="#666">Click input file</text>
                
                <!-- Arrow 1 -->
                <path d="M 275 135 L 375 135" stroke="#000" stroke-width="2" marker-end="url(#arrow)"/>
                
                <!-- Step 2 -->
                <rect x="375" y="110" width="200" height="50" fill="#e8f5e9" stroke="#66bb6a" stroke-width="2" rx="5"/>
                <text x="475" y="135" font-size="13" text-anchor="middle" font-weight="bold">2. Preview imagen</text>
                <text x="475" y="152" font-size="11" text-anchor="middle" fill="#666">FileReader API</text>
                
                <!-- Step 3 -->
                <rect x="75" y="190" width="200" height="50" fill="#e3f2fd" stroke="#42a5f5" stroke-width="2" rx="5"/>
                <text x="175" y="215" font-size="13" text-anchor="middle" font-weight="bold">3. Click "Run"</text>
                <text x="175" y="232" font-size="11" text-anchor="middle" fill="#666">Ejecutar detecci√≥n</text>
                
                <!-- Arrow 3 -->
                <path d="M 275 215 L 375 215" stroke="#000" stroke-width="2" marker-end="url(#arrow)"/>
                
                <!-- Step 4 -->
                <rect x="375" y="190" width="200" height="50" fill="#e8f5e9" stroke="#66bb6a" stroke-width="2" rx="5"/>
                <text x="475" y="212" font-size="13" text-anchor="middle" font-weight="bold">4. POST /predict</text>
                <text x="475" y="229" font-size="11" text-anchor="middle" fill="#666">multipart/form-data</text>
                
                <!-- Arrow 4 -->
                <path d="M 575 215 L 675 215" stroke="#000" stroke-width="2" marker-end="url(#arrow)"/>
                
                <!-- Step 5 -->
                <rect x="675" y="190" width="200" height="50" fill="#fff3e0" stroke="#ffa726" stroke-width="2" rx="5"/>
                <text x="775" y="212" font-size="13" text-anchor="middle" font-weight="bold">5. Leer imagen</text>
                <text x="775" y="229" font-size="11" text-anchor="middle" fill="#666">PIL.Image.open()</text>
                
                <!-- Step 6 -->
                <rect x="675" y="270" width="200" height="70" fill="#fff3e0" stroke="#ffa726" stroke-width="2" rx="5"/>
                <text x="775" y="292" font-size="13" text-anchor="middle" font-weight="bold">6. Preprocesar</text>
                <text x="775" y="309" font-size="10" text-anchor="middle" fill="#666">‚Ä¢ Resize 320√ó320</text>
                <text x="775" y="324" font-size="10" text-anchor="middle" fill="#666">‚Ä¢ Normalizar</text>
                <text x="775" y="339" font-size="10" text-anchor="middle" fill="#666">‚Ä¢ ToTensor()</text>
                
                <!-- Arrow 6 -->
                <path d="M 875 305 L 950 305" stroke="#000" stroke-width="2" marker-end="url(#arrow)"/>
                
                <!-- Step 7 -->
                <rect x="950" y="270" width="200" height="70" fill="#f3e5f5" stroke="#ab47bc" stroke-width="2" rx="5"/>
                <text x="1050" y="292" font-size="13" text-anchor="middle" font-weight="bold">7. Forward Pass</text>
                <text x="1050" y="309" font-size="10" text-anchor="middle" fill="#666">MobileNetV3</text>
                <text x="1050" y="324" font-size="10" text-anchor="middle" fill="#666">Input: [1,3,320,320]</text>
                <text x="1050" y="339" font-size="10" text-anchor="middle" fill="#666">Output: logits [2]</text>
                
                <!-- Arrow 7 (return) -->
                <path d="M 950 350 L 875 350" stroke="#ab47bc" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowpurple2)"/>
                
                <!-- Step 8 -->
                <rect x="675" y="370" width="200" height="60" fill="#fff3e0" stroke="#ffa726" stroke-width="2" rx="5"/>
                <text x="775" y="392" font-size="13" text-anchor="middle" font-weight="bold">8. Softmax</text>
                <text x="775" y="409" font-size="10" text-anchor="middle" fill="#666">Calcular probabilidades</text>
                <text x="775" y="424" font-size="10" text-anchor="middle" fill="#666">fake: 0.9996, real: 0.0004</text>
                
                <!-- Arrow 8 -->
                <path d="M 675 400 L 575 400" stroke="#ffa726" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arroworange2)"/>
                
                <!-- Step 9 -->
                <rect x="375" y="370" width="200" height="100" fill="#e8f5e9" stroke="#66bb6a" stroke-width="2" rx="5"/>
                <text x="475" y="392" font-size="13" text-anchor="middle" font-weight="bold">9. Recibir JSON</text>
                <text x="475" y="409" font-size="10" text-anchor="middle" fill="#666">{</text>
                <text x="475" y="424" font-size="10" text-anchor="middle" fill="#666">prediction: "fake",</text>
                <text x="475" y="439" font-size="10" text-anchor="middle" fill="#666">probabilities: {...}</text>
                <text x="475" y="454" font-size="10" text-anchor="middle" fill="#666">}</text>
                
                <!-- Arrow 9 -->
                <path d="M 375 420 L 275 420" stroke="#66bb6a" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowgreen2)"/>
                
                <!-- Step 10 -->
                <rect x="75" y="500" width="200" height="60" fill="#e3f2fd" stroke="#42a5f5" stroke-width="2" rx="5"/>
                <text x="175" y="522" font-size="13" text-anchor="middle" font-weight="bold">10. Mostrar resultados</text>
                <text x="175" y="539" font-size="10" text-anchor="middle" fill="#666">Actualizar tabla DOM</text>
                <text x="175" y="554" font-size="10" text-anchor="middle" fill="#666">con probabilidades</text>
                
                <!-- Time indicators -->
                <text x="30" y="140" font-size="11" fill="#999">t0</text>
                <text x="30" y="220" font-size="11" fill="#999">t1</text>
                <text x="30" y="310" font-size="11" fill="#999">t2</text>
                <text x="30" y="405" font-size="11" fill="#999">t3</text>
                <text x="30" y="535" font-size="11" fill="#999">t4</text>
                
                <!-- Arrow markers -->
                <defs>
                    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                        <path d="M0,0 L0,6 L9,3 z" fill="#000"/>
                    </marker>
                    <marker id="arrowpurple2" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                        <path d="M0,0 L0,6 L9,3 z" fill="#ab47bc"/>
                    </marker>
                    <marker id="arroworange2" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                        <path d="M0,0 L0,6 L9,3 z" fill="#ffa726"/>
                    </marker>
                    <marker id="arrowgreen2" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                        <path d="M0,0 L0,6 L9,3 z" fill="#66bb6a"/>
                    </marker>
                </defs>
                
                <!-- Total time -->
                <rect x="400" y="600" width="400" height="50" fill="#ffebee" stroke="#f44336" stroke-width="2" rx="5"/>
                <text x="600" y="625" font-size="14" text-anchor="middle" font-weight="bold" fill="#d32f2f">‚è±Ô∏è Tiempo total de inferencia: ~1-2 segundos</text>
                <text x="600" y="643" font-size="11" text-anchor="middle" fill="#666">(depende de tama√±o imagen y hardware)</text>
            </svg>
        </div>

        <!-- Diagrama 3: Arquitectura del Modelo -->
        <div class="diagram-section">
            <h2 class="diagram-title">3. Arquitectura del Modelo MobileNetV3-Small</h2>
            <svg width="1200" height="650" xmlns="http://www.w3.org/2000/svg">
                <rect x="0" y="0" width="1200" height="650" fill="#f8f9fa"/>
                
                <!-- Input -->
                <rect x="100" y="50" width="180" height="80" fill="#e3f2fd" stroke="#1976d2" stroke-width="3" rx="8"/>
                <text x="190" y="80" font-size="16" font-weight="bold" text-anchor="middle">üì• Input</text>
                <text x="190" y="105" font-size="13" text-anchor="middle" fill="#666">Tensor Shape:</text>
                <text x="190" y="122" font-size="12" text-anchor="middle" fill="#1976d2">[1, 3, 320, 320]</text>
                
                <!-- Arrow -->
                <path d="M 190 130 L 190 170" stroke="#000" stroke-width="3" marker-end="url(#arrow3)"/>
                
                <!-- Feature Extraction Block -->
                <rect x="50" y="170" width="280" height="320" fill="#fff3e0" stroke="#f57c00" stroke-width="3" rx="8"/>
                <text x="190" y="200" font-size="16" font-weight="bold" text-anchor="middle" fill="#f57c00">üîß Feature Extraction</text>
                <text x="190" y="220" font-size="13" text-anchor="middle" fill="#666">(Pre-trained on ImageNet)</text>
                
                <!-- Sub-blocks -->
                <rect x="70" y="240" width="240" height="50" fill="#fff" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="190" y="265" font-size="13" text-anchor="middle" font-weight="bold">Convolutional Blocks</text>
                <text x="190" y="282" font-size="11" text-anchor="middle" fill="#666">3√ó3 convolutions</text>
                
                <rect x="70" y="305" width="240" height="50" fill="#fff" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="190" y="327" font-size="13" text-anchor="middle" font-weight="bold">Inverted Residuals</text>
                <text x="190" y="344" font-size="11" text-anchor="middle" fill="#666">Bottleneck architecture</text>
                
                <rect x="70" y="370" width="240" height="50" fill="#fff" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="190" y="392" font-size="13" text-anchor="middle" font-weight="bold">Squeeze-Excitation</text>
                <text x="190" y="409" font-size="11" text-anchor="middle" fill="#666">Channel attention</text>
                
                <rect x="70" y="435" width="240" height="50" fill="#fff" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="190" y="457" font-size="13" text-anchor="middle" font-weight="bold">h-swish Activation</text>
                <text x="190" y="474" font-size="11" text-anchor="middle" fill="#666">Non-linear activation</text>
                
                <!-- Arrow -->
                <path d="M 330 330 L 420 330" stroke="#000" stroke-width="3" marker-end="url(#arrow3)"/>
                <text x="375" y="320" font-size="12" fill="#666">Features</text>
                
                <!-- Global Average Pooling -->
                <rect x="420" y="290" width="180" height="80" fill="#e8f5e9" stroke="#388e3c" stroke-width="3" rx="8"/>
                <text x="510" y="320" font-size="15" font-weight="bold" text-anchor="middle" fill="#388e3c">Global Avg Pool</text>
                <text x="510" y="340" font-size="12" text-anchor="middle" fill="#666">Reduce spatial dims</text>
                <text x="510" y="358" font-size="11" text-anchor="middle" fill="#999">[B, C, H, W] ‚Üí [B, C]</text>
                
                <!-- Arrow -->
                <path d="M 600 330 L 690 330" stroke="#000" stroke-width="3" marker-end="url(#arrow3)"/>
                
                <!-- Classifier Head -->
                <rect x="690" y="240" width="220" height="180" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="3" rx="8"/>
                <text x="800" y="270" font-size="16" font-weight="bold" text-anchor="middle" fill="#7b1fa2">üéØ Classifier Head</text>
                <text x="800" y="290" font-size="12" text-anchor="middle" fill="#666">(Fine-tuned)</text>
                
                <rect x="710" y="305" width="180" height="50" fill="#fff" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="800" y="327" font-size="13" text-anchor="middle" font-weight="bold">Dropout(0.2)</text>
                <text x="800" y="344" font-size="11" text-anchor="middle" fill="#666">Regularization</text>
                
                <rect x="710" y="365" width="180" height="50" fill="#fff" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="800" y="387" font-size="13" text-anchor="middle" font-weight="bold">Linear(in ‚Üí 2)</text>
                <text x="800" y="404" font-size="11" text-anchor="middle" fill="#666">Output layer</text>
                
                <!-- Arrow -->
                <path d="M 910 330 L 1000 330" stroke="#000" stroke-width="3" marker-end="url(#arrow3)"/>
                
                <!-- Output -->
                <rect x="1000" y="270" width="150" height="120" fill="#ffebee" stroke="#d32f2f" stroke-width="3" rx="8"/>
                <text x="1075" y="300" font-size="16" font-weight="bold" text-anchor="middle" fill="#d32f2f">üì§ Output</text>
                <text x="1075" y="325" font-size="13" text-anchor="middle" fill="#666">Logits [2]
